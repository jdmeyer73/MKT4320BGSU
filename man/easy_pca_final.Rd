% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/easy_pca_final.R
\name{easy_pca_final}
\alias{easy_pca_final}
\title{Easy PCA (Final Retained Solution)}
\usage{
easy_pca_final(data, vars, comp, group = NULL, ft = TRUE)
}
\arguments{
\item{data}{A data frame containing the full dataset.}

\item{vars}{Character vector of variable names to use in PCA (required).
All variables must be numeric.}

\item{comp}{Integer; number of components to retain.}

\item{group}{Optional; single variable name (string) to aggregate by before PCA.}

\item{ft}{Logical; if \code{TRUE}, return \code{$unrotated} and \code{$rotated}
as flextables (default = \code{TRUE}).}
}
\value{
A list with components:
\describe{
\item{table}{Eigenvalue table (data.frame).}
\item{unrotated}{Unrotated loading table + Unexplained (data.frame or flextable).}
\item{rotated}{Varimax-rotated loading table + Unexplained (data.frame or flextable).}
\item{pcaobj}{The fitted \code{prcomp} object.}
\item{key}{Row ids (ungrouped) or group labels (grouped), aligned to \code{data_used}.}
\item{data_used}{Numeric data actually used in PCA (after preprocessing).}
}
}
\description{
Fit PCA and return retained-component loadings (unrotated and varimax-rotated),
plus eigen diagnostics. Supports optional grouping/aggregation.
}
\details{
PCA is fit using \code{\link[stats:prcomp]{stats::prcomp}} with
\code{center = TRUE} and \code{scale. = TRUE}. If \code{group} is supplied,
PCA is fit on mean-aggregated values of \code{vars} by group. Rows (or
groups) with missing values in \code{vars} are dropped prior to fitting.

Loadings are computed from the retained components and a varimax rotation is
applied using \code{\link[stats:varimax]{stats::varimax}}. The \code{Unexplained}
column is \eqn{1 -} communality for standardized variables.
}
\examples{
\dontrun{
final <- easy_pca_final(
  data = mydata,
  vars = c("perform", "leader", "fun", "serious", "bargain", "value"),
  comp = 2
)
final$unrotated
final$rotated
}

}
